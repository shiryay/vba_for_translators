# Инструкция

## Подготовка
### Загрузка
Для установки макроса нужно скачать архив из репозитория и распаковать его в произвольную папку - см. [видео](https://youtu.be/NgiGh2X_t60).
### Активация редактора Visual Basic
При работе с макросами используется среда Visual Basic Editor (VBE). Если на панели инструментов не отображается вкладка "Разработчик", ее необходимо активировать в настройках Word. После [активации вкладки] (https://youtu.be/mbRbBo0L-bk) необходимо открыть среду VBE, для чего используется либо кнопка (первая) на панели "Разработчик", либо клавиатурное сочетание <Alt+F11>
### Подключение библиотек
Для работы некоторых функций макроса требуется подключение дополнительных библиотек. Это можно сделать из меню редактора Visual Basic, см. [видео](https://youtu.be/ZRvYTpc3FEo). Необходимые библиотеки показаны на [рисунке](vba_refs.png).
## Установка
Чтобы установить пакет макросов, необходимо импортировать файлы CheckerModule.bas, SearchModule.bas и UtilityModule.bas в шаблон Normal, см. [видео](https://youtu.be/ILcAh5u-_aE). Также необходимо скопировать файл "regexes.csv" в папку автоматически подключаемых шаблонов Word. Это можно сделать автоматически, запустив файл "copy_regexes.bat" из распакованной папки. Если автоматически сделать это не получается, файл "regexes.csv" нужно скопировать вручную, уточнив местонахождение папки "Word\STARTUP". Путь к папке можно найти в настройках Word или скопировать его в буфер обмена, как показано в видео по [ссылке](https://youtu.be/n7lLFU8Rt8o).
## Варианты запуска
Запустить макрос в Microsoft Word можно несколькими способами.
### Окно "Запуск макроса"
Окно запуска макросов открывается с помощью второй кнопки на вкладке "Разработчик" или с помощью клавиатурного сочетания <Alt+F8>. В видео по [ссылке](https://youtu.be/n7lLFU8Rt8o) показан запуск макроса для копирования пути к автоматически запускаемым шаблонам Word и копирование файла настроек проверки regexes.csv. 
### Назначение кнопки на панели быстрого запуска
Для более быстрого запуска макроса можно [создать кнопку на панели задач](https://youtu.be/DUisOGV_toI).
### Использование горячих клавиш
Некоторые макросы удобней запускать с помощью горячих клавиш, [назначаемых](https://youtu.be/ut2LKJq5JcU) в настройках клавиатуры окна параметров Word.
## Состав макроса
### SearchModule
Сайты для поиска (указаны мои клавиатурные сочетания, каждый может [настроить](https://youtu.be/ut2LKJq5JcU) для себя):
+ Google, google.ru (Alt+G)
+ GoogleBooks, собственно Google Books (Alt+B)
+ GoogleTr, перевод выделенного текста на английский в Google Translate (Alt+T)
+ LingueeDeEn, linguee.de (Alt+D)
+ LingueeRuEn, linguee.ru (Alt+B)
+ LingueeEsEn, испанский через linguee.com (Alt+S)
+ LingueeFrEn, linguee.fr (Alt+F)
+ Proz, сейчас просто поиск фразы через Google с добавлением к запросу "english proz" (Alt+P)
+ Insur, словарь страховых терминов на insur-info.ru (Alt+I)
+ Colloc, ozdic.com (небольшой словарь сочетаемости) (Alt+C)
+ Multitran, multitran.com (Alt+M)
+ Abkuerzungen, abkuerzungen.de (Alt+K)
+ Acronymfinder, acronymfinder.com (Alt+A)
+ Wox, abkuerzungen.woxikon.de (практически не пользуюсь, клавишу не назначал)
+ Sokr, sokr.ru (Alt+.)

На каждый макрос/сайт желательно назначить клавиатурное сочетание. В качестве запроса используется выделенное слово(сочетание). Если ничего не выделено, выводится окно для ввода запроса.

Плюс еще запуск мультитрана на компьютере (макрос mul), который у меня настроен на Alt+Z (возможно, кроме клавиши, потребуется настроить и путь к программе)
### CheckerModule
Здесь все просто, основной макрос CheckMain, который можно запустить по Alt+F8 или, что незначительно быстрее, с помощью назначенной кнопки или клавиатурного сокращения. Макрос выделяет всякие "непотребства" и открывает файл отчета.

Макрос может выделять то, что не является ошибкой. Перед запуском рекомендуется сохраниться, чтобы избежать возможных неприятных сюрпризов.

В модуле есть также макрос удаления отчета, но его можно удалить и вручную. Остальные макросы в модуле запускать вручную вряд ли потребуется.
### UtilityModule
Данный модуль содержит в основном вспомогательные функции:

+ KillHiddenText - соответственно удаляет скрытый текст, вдруг пригодится
+ PasteAsIs - сделал для себя вставку с сохранением исходного форматирования, так как по умолчанию у меня установлен вариант "Сохранять только текст", привязал комбинацию Ctrl+Shift+I
+ ConvertDates - преобразует даты в текущем документе в американский формат (и обратно, но разделитель согласно последним веяниям все равно останется слэш)
+ CopyStartupPath - копирует в буфер обмена путь к папке с автоматически загружаемыми шаблонами Word (не супер полезная)

